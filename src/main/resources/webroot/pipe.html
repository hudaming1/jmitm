<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>WireTiger PipeManager</title>
		<link rel="stylesheet" type="text/css" href="jquery-easyui-1.9.7/themes/metro/easyui.css">
		<link rel="stylesheet" type="text/css" href="jquery-easyui-1.9.7/themes/icon.css">
		<link rel="stylesheet" type="text/css" href="../demo.css">
		<script type="text/javascript" src="jquery-easyui-1.9.7/jquery.min.js"></script>
		<script type="text/javascript" src="jquery-easyui-1.9.7/jquery.easyui.min.js"></script>
		<script type="text/javascript">
			function dgClickRow(index, row) {
				$.get("/pipe/get?id=" + row.requestId, function(resp) {
				
					// load data
					var jsonObj = eval("(" + resp + ")");
					$("#requestPannel").html(jsonObj.requestString);
					$("#responsePannel").html(jsonObj.responseString);
					$("#timelineDg").datagrid("loadData", jsonObj.statusTimeline);
					$("#eventsDg").datagrid("loadData", jsonObj.pipeEvent);
					// expand east_panel
					if($("#eastPannel").panel("options")["collapsed"] == true) {
						$("body").layout("expand", "east");
					}
					
					// resize layout
					$("#eastPannel").panel("doLayout");
					$("#tab").panel("doLayout");
					$("#tab-tools").panel("doLayout");
				});
			}
			
			$(function(){
		        $('#filterBtn').switchbutton({
		            checked: true,
		            onChange: function(checked){
		                $("#dgMain").datagrid("load", {
				        	active: checked
				        });
		            }
		        });
		        $("#dgMain").datagrid("load", {
		        	active: true
		        });
		    })
		    
			$(function() {
				$("body").layout("collapse", "east");
			})
			
		</script>
	</head>
	<body class="easyui-layout" data-options="">
		<div id="centerLayout" data-options="region:'center'" style="padding:0px; width:40%">
			<div id="tb" style="padding:5px;height:auto">
				<input id="filterBtn" class="easyui-switchbutton" checked style="width:60px;height:20px" />
			</div>
			<table class="easyui-datagrid" id="dgMain" data-options="remoteSort: false, fit:true, toolbar:'#tb', onClickRow:dgClickRow, border:false,striped:true,singleSelect:true,collapsible:true,url:'/pipe/list',method:'get'">
				<thead>
					<tr>
						<th data-options="field:'requestId', hidden:true">reqeustId</th>
						<th data-options="field:'name', width: '80%'">Name</th>
						<th data-options="field:'protocol', width:55, align: 'center'">/</th>
						<th data-options="field:'status', width:80, align: 'center'">Status</th>
					</tr>
				</thead>
			</table>
		</div>
		<div class="easyui-layout" id="eastPannel" data-options="region:'east',split:true" style="width:60%;">
		    <div id="tab-tools">
		        <a href="javascript:void(0)" class="easyui-linkbutton" data-options="plain:true" onclick="$('body').layout('collapse', 'east');">Ã—</a>
		    </div>
			<div class="easyui-tabs" id="tab" data-options="tools:'#tab-tools', region:'center', border:false, plain:true, tabWidth:100, tabPosition: 'top'">
		        <div title="Timeline" data-options="" id="processPanel" style="padding:5px 5px 50px 5px;">
				    <table class="easyui-datagrid" id="timelineDg" data-options="border:false">
				        <thead>
				            <tr>
				                <th data-options="field:'status',width:100">Status</th>
				                <th data-options="field:'time',width:200, align:'center'">Time</th>
				                <th data-options="field:'cost',width:120, align:'center'">Cost</th>
				            </tr>
				        </thead>
				    </table>
		        </div>
		        <div title="Events" data-options="" id="eventsPannel" style="padding:5px 5px 50px 5px;">
				    <table class="easyui-datagrid" id="eventsDg" data-options="border:false">
				        <thead>
				            <tr>
				                <th data-options="field:'type',width:100, hidden:true">EventType</th>
				                <th data-options="field:'desc',width:300">Event Desc</th>
				                <th data-options="field:'time',width:200, align:'center'">Event Time</th>
				            </tr>
				        </thead>
				    </table>
		        </div>
				<div title="Request" data-options="fit:true, border:false" class="easyui-layout" >
					<div id="requestPannel" data-options="border:false, title:'SourceText',region:'north',split:true,collapsible:false" style="height:100%;padding:5px 5px 50px 5px;">
					</div>
				</div>
				<div title="Response" data-options="fit:true, border:false" class="easyui-layout" >
					<div id="responsePannel" data-options="title:'SourceText',region:'center', border:false,split:true,collapsible:false" style="height:100%;padding:5px 5px 50px 5px;">
					</div>
				</div>
			</div>
		</div>
	</body>
</html>